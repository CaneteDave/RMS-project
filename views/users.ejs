<%- include('./layout/header.ejs')  %>  
<div class="">
  <div class="row min-vh-100">
    <div class="col-sm-2">
      <div class="d-flex flex-column min-vh-100">
        <div>
          <a href="#">Branding</a>
        </div>
        <div>
          <a href="/users">Users</a>
        </div>
        <div>
          <a href="#">System Variables</a>
        </div>
        <div class="mt-auto">
          <a href="#">BACK TO JOB PAGE</a>
        </div>
      </div>
    </div>
    <div class="col-sm-10">
      <h2>Users</h2>
      <p>User Accounts</p>            
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>image</th>
            <th>Name</th>
            <th>password</th>
            <th>role</th>
            <th>email</th>
          </tr>
        </thead>
        <% for (let  i = 0; i < users.length; i++) { %>
          <form method="post" action="/edit/<%=users[i].user_id %>"> 
      <% if (users[i].user_id == '1') { %>  
      <tr>
      <th><i class="fa-solid fa-user"></i></th>
      <th><input type="text" name="user_name" value="<%= users[i].user_name %>" ></th>
      <th><input type="password" name="password" value="<%= users[i].password%>" ></th>
      <TD class = "select">
        <select name="role_name">  
          <% for (let  j = 0; j < userRole.length; j++) { %>
                <% if (userRole[j].role_id == users[i].role_id) { %>  
              <option value="<%= userRole[j].role_id %>" selected><%= userRole[j].role_name %></option>
                  <% } else { %>
              <option value="<%= userRole[j].role_id %>"><%= userRole[j].role_name %></option>
                  <% } %>
          <% } %>
        </select>
        </TD>   
      <th><input type="text" name="email" value="<%= users[i].email %>" ></th>
      <td>
        <form method="post" action="/edit/<%=users[i].user_id%>" >
          <button type="submit"><i class="fa-solid fa-check"></i></button>
        </form>
      </td>
      <th></th>
    </tr>
  </form>
<% } else { %>
      <tr>
      <th><img src="<%= users[i].photo %> " width="50" height="50" class="img-thumbnail" ></th> 
      <th><input type="text" name="user_name" value="<%= users[i].user_name %>" ></th>
      <th><input type="password" name="password" value="<%= users[i].password%>" ></th>
      <TD class = "select">
        <select name="role_name"> 
        <% for (let  j = 0; j < userRole.length; j++) { %>
            <% if (userRole[j].role_id == users[i].role_id) { %>  
        <option value="<%= userRole[j].role_id %>" selected><%= userRole[j].role_name %></option>
          <% } else { %>
        <option value="<%= userRole[j].role_id %>"><%= userRole[j].role_name %></option>
            <% } %>
        <% } %>
        </select>
        </TD>   
      <th><input type="text" name="email" value="<%= users[i].email %>" ></th>
      <td>
        <form method="post" action="/edit/<%=users[i].user_id%>" >
          <button type="submit"><i class="fa-solid fa-check"></i></button>
        </form>
      </td>
      <td>
        <form method="GET" action="/delete/<%= users[i].user_id%>"> 
          <button type="submit"><i class="fa-solid fa-x"></i></button>
        </form>
      </td>
    </tr>
    <% } %>
    <% } %>
    <form method="post" action="/users" encType="multipart/form-data" >
      <th> 
        <label for="photo"><i class="fa-solid fa-plus" ></i></label>
        <input type="file" id="photo" name="photo" style="display: contents;"></i>
      </th>
      <th><input type="text" placeholder="Enter Name" name="user_name" required></th>
      <th><input type="password" placeholder="Enter Password" name="password"></th>
      <th>
      <select name="role_name" >     
        <% for (let  i = 0; i < userRole.length; i++) { %>  
        <option value=<%= userRole[i].role_id %>><%= userRole[i].role_name %></option>
        <% } %> 
      </select></th>
      <th><input type="text" placeholder="Enter Email Address" name="email"></th>
      <th><button type="submit"><i class="fa-solid fa-plus"></i></button></th>
    </form>
    <th></th>
  </table>
  </div>
  </div>
</div>
<%- include('./layout/footer.ejs')  %>  